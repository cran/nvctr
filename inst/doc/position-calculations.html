<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Enrico Spinielli" />

<meta name="date" content="2019-03-06" />

<title>Simple and Exact Solutions to Position Calculation</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Simple and Exact Solutions to Position Calculation</h1>
<h4 class="author"><em>Enrico Spinielli</em></h4>
<h4 class="date"><em>2019-03-06</em></h4>


<div id="TOC">
<ul>
<li><a href="#example-01">Example 1: A and B to delta</a></li>
<li><a href="#example-02">Example 2: B and delta to C</a></li>
<li><a href="#example-3-ecef-vector-to-geodetic-latitude">Example 3: ECEF-vector to geodetic latitude</a></li>
<li><a href="#example-4-geodetic-latitude-to-ecef-vector">Example 4: Geodetic latitude to ECEF-vector</a></li>
<li><a href="#example-05">Example 5: Surface distance</a></li>
<li><a href="#example-6-interpolated-position">Example 6: Interpolated position</a></li>
<li><a href="#example-7-mean-position-centermidpoint">Example 7: Mean position (center/midpoint)</a></li>
<li><a href="#example-8-a-and-azimuthdistance-to-b">Example 8: A and azimuth/distance to B</a></li>
<li><a href="#example-9-intersection-of-two-paths">Example 9: Intersection of two paths</a></li>
<li><a href="#example-10-cross-track-distance-cross-track-error">Example 10: Cross track distance (cross track error)</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>This vignette contains solutions to various geographical position calculations. It is inspired and follows the 10 examples given at <a href="https://www.navlab.net/nvector/" class="uri">https://www.navlab.net/nvector/</a> .</p>
<p>Most of the content is based on <span class="citation">(Gade <a href="#ref-gade2010">2010</a>)</span>.</p>
<p>The color scheme in the Figures is as follows:</p>
<ul>
<li><span class="math inline">\(\mathbf{\color{red}{Red}}\)</span>: Given</li>
<li><span class="math inline">\(\mathbf{\color{green}{Green}}\)</span>: Find this</li>
</ul>
<div id="example-01" class="section level2">
<h2>Example 1: A and B to delta</h2>
<p>Given two positions <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, find the exact vector from <span class="math inline">\(A\)</span> to <span class="math inline">\(B\)</span> in meters north, east and down, and find the direction (azimuth/bearing) to <span class="math inline">\(B\)</span>, relative to north. Use WGS-84 ellipsoid.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="A and B to delta." width="220px" />
<p class="caption">
A and B to delta.
</p>
</div>
<div id="solution" class="section level3">
<h3>Solution</h3>
<p>Transform the positions <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> to (decimal) degrees and depths:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Position A:</span>
lat_EA &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">1</span>)
lon_EA &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">2</span>)
z_EA &lt;-<span class="st"> </span><span class="dv">3</span>

<span class="co"># Position B:</span>
lat_EB &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">4</span>)
lon_EB &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">5</span>)
z_EB &lt;-<span class="st"> </span><span class="dv">6</span></code></pre></div>
<p><strong>Step 1</strong>: Convert to n-vectors, <span class="math inline">\(\mathbf{n}_{EA}^E\)</span> and <span class="math inline">\(\mathbf{n}_{EB}^E\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(n_EA_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(lat_EA, lon_EA))
<span class="co">#&gt; [1] 0.99923861 0.03489418 0.01745241</span>
(n_EB_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(lat_EB, lon_EB))
<span class="co">#&gt; [1] 0.99376802 0.08694344 0.06975647</span></code></pre></div>
<p><strong>Step 2</strong>: Find <span class="math inline">\(\mathbf{p}_{AB}^E\)</span> (delta decomposed in E). WGS-84 ellipsoid is default</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(p_AB_E &lt;-<span class="st">  </span><span class="kw">n_EA_E_and_n_EB_E2p_AB_E</span>(n_EA_E, n_EB_E, z_EA, z_EB))
<span class="co">#&gt; [1] -34798.44 331985.66 331375.96</span></code></pre></div>
<p><strong>Step 3</strong>: Find <span class="math inline">\(\mathbf{R}_{EN}\)</span> for position <span class="math inline">\(A\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(R_EN &lt;-<span class="st"> </span><span class="kw">n_E2R_EN</span>(n_EA_E))
<span class="co">#&gt;               [,1]       [,2]        [,3]</span>
<span class="co">#&gt; [1,] -0.0174417749 -0.0348995 -0.99923861</span>
<span class="co">#&gt; [2,] -0.0006090802  0.9993908 -0.03489418</span>
<span class="co">#&gt; [3,]  0.9998476952  0.0000000 -0.01745241</span></code></pre></div>
<p><strong>Step 4</strong>: Find <span class="math inline">\(\mathbf{p}_{AB}^N = \mathbf{R}_{NE} \mathbf{p}_{AB}^E\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># (Note the transpose of R_EN: The &quot;closest-rule&quot; says that when</span>
<span class="co"># decomposing, the frame in the subscript of the rotation matrix that is</span>
<span class="co"># closest to the vector, should equal the frame where the vector is</span>
<span class="co"># decomposed. Thus the calculation R_NE*p_AB_E is correct, since the vector</span>
<span class="co"># is decomposed in E, and E is closest to the vector. In the above example</span>
<span class="co"># we only had R_EN, and thus we must transpose it: base::t(R_EN) = R_NE)</span>
(p_AB_N &lt;-<span class="st"> </span>base<span class="op">::</span><span class="kw">t</span>(R_EN) <span class="op">%*%</span><span class="st"> </span>p_AB_E <span class="op">%&gt;%</span><span class="st">  </span>
<span class="st">  </span><span class="kw">as.vector</span>())
<span class="co">#&gt; [1] 331730.23 332997.87  17404.27</span></code></pre></div>
<p><strong>Step 5</strong>: Also find the direction (azimuth) to <span class="math inline">\(B\)</span>, relative to north</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(azimuth &lt;-<span class="st"> </span><span class="kw">atan2</span>(p_AB_N[<span class="dv">2</span>], p_AB_N[<span class="dv">1</span>]) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># positive angle about down-axis</span>
<span class="st">  </span><span class="kw">deg</span>())
<span class="co">#&gt; [1] 45.10926</span></code></pre></div>
</div>
</div>
<div id="example-02" class="section level2">
<h2>Example 2: B and delta to C</h2>
<p>A radar or sonar attached to a vehicle <span class="math inline">\(B\)</span> (<strong>B</strong>ody coordinate frame) measures the distance and direction to an object <span class="math inline">\(C\)</span>.</p>
<p>We assume that the distance and two angles (typically bearing and elevation relative to <span class="math inline">\(B\)</span>) are already combined to the vector <span class="math inline">\(\mathbf{p}_{BC}^B\)</span> (i.e. the vector from <span class="math inline">\(B\)</span> to <span class="math inline">\(C\)</span>, decomposed in B).</p>
<p>The position of <span class="math inline">\(B\)</span> is given as <span class="math inline">\(\mathbf{n}_{EB}^E\)</span> and <span class="math inline">\(z_{EB}\)</span>, and the orientation (attitude) of <span class="math inline">\(B\)</span> is given as <span class="math inline">\(\mathbf{R}_{NB}\)</span> (this rotation matrix can be found from roll/pitch/yaw by using <code>zyx2R</code>).</p>
<p>Find the exact position of object <span class="math inline">\(C\)</span> as n-vector and depth (<span class="math inline">\(\mathbf{n}_{EC}^E\)</span> and <span class="math inline">\(z_{EC}\)</span>), assuming Earth ellipsoid with semi-major axis <span class="math inline">\(a\)</span> and flattening <span class="math inline">\(f\)</span>.</p>
<p>For WGS-72, use <span class="math inline">\(a = 6378135~\mathrm{m}\)</span> and <span class="math inline">\(f = \dfrac{1}{298.26}\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="B and delta to C." width="220px" />
<p class="caption">
B and delta to C.
</p>
</div>
<div id="solution-1" class="section level3">
<h3>Solution</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p_BC_B &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3000</span>, <span class="dv">2000</span>, <span class="dv">100</span>)

<span class="co"># Position and orientation of B is given:</span>
(n_EB_E &lt;-<span class="st"> </span><span class="kw">unit</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))) <span class="co"># unit() to get unit length of vector</span>
<span class="co">#&gt; [1] 0.2672612 0.5345225 0.8017837</span>
z_EB &lt;-<span class="st"> </span><span class="op">-</span><span class="dv">400</span>
(R_NB &lt;-<span class="st"> </span><span class="kw">zyx2R</span>(<span class="kw">rad</span>(<span class="dv">10</span>),<span class="kw">rad</span>(<span class="dv">20</span>),<span class="kw">rad</span>(<span class="dv">30</span>))) <span class="co"># the three angles are yaw, pitch, and roll</span>
<span class="co">#&gt;            [,1]       [,2]       [,3]</span>
<span class="co">#&gt; [1,]  0.9254166 0.01802831  0.3785223</span>
<span class="co">#&gt; [2,]  0.1631759 0.88256412 -0.4409696</span>
<span class="co">#&gt; [3,] -0.3420201 0.46984631  0.8137977</span>

<span class="co"># A custom reference ellipsoid is given (replacing WGS-84):</span>
<span class="co"># (WGS-72)</span>
a &lt;-<span class="st"> </span><span class="dv">6378135</span>
f &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="fl">298.26</span> </code></pre></div>
<p><strong>Step 1</strong>: Find <span class="math inline">\(\mathbf{R}_{EN}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(R_EN &lt;-<span class="st"> </span><span class="kw">n_E2R_EN</span>(n_EB_E))
<span class="co">#&gt;            [,1]       [,2]       [,3]</span>
<span class="co">#&gt; [1,] -0.3585686 -0.8944272 -0.2672612</span>
<span class="co">#&gt; [2,] -0.7171372  0.4472136 -0.5345225</span>
<span class="co">#&gt; [3,]  0.5976143  0.0000000 -0.8017837</span></code></pre></div>
<p><strong>Step 2</strong>: Find <span class="math inline">\(\mathbf{R}_{EB}\)</span> from <span class="math inline">\(\mathbf{R}_{EN}\)</span> and <span class="math inline">\(\mathbf{R}_{NB}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(R_EB &lt;-<span class="st"> </span>R_EN <span class="op">%*%</span><span class="st"> </span>R_NB) <span class="co"># Note: closest frames cancel</span>
<span class="co">#&gt;            [,1]       [,2]        [,3]</span>
<span class="co">#&gt; [1,] -0.3863656 -0.9214254  0.04119242</span>
<span class="co">#&gt; [2,] -0.4078587  0.1306225 -0.90365318</span>
<span class="co">#&gt; [3,]  0.8272684 -0.3659411 -0.42627939</span></code></pre></div>
<p><strong>Step 3</strong>: Decompose the delta vector <span class="math inline">\(\mathbf{p}_{BC}^B\)</span> in E</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(p_BC_E &lt;-<span class="st"> </span>R_EB <span class="op">%*%</span><span class="st"> </span>p_BC_B) <span class="co"># no transpose of R_EB, since the vector is in B)</span>
<span class="co">#&gt;           [,1]</span>
<span class="co">#&gt; [1,] -2997.828</span>
<span class="co">#&gt; [2,] -1052.696</span>
<span class="co">#&gt; [3,]  1707.295</span></code></pre></div>
<p><strong>Step 4</strong>: Find the position of <span class="math inline">\(C\)</span>, using the functions that goes from one position and a delta, to a new position</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l &lt;-<span class="st"> </span><span class="kw">n_EA_E_and_p_AB_E2n_EB_E</span>(n_EB_E, p_BC_E, z_EB, a, f)
(n_EB_E &lt;-<span class="st"> </span>l[[<span class="st">'n_EB_E'</span>]])
<span class="co">#&gt; [1] 0.2667916 0.5343565 0.8020507</span>
(z_EB &lt;-<span class="st"> </span>l[[<span class="st">'z_EB'</span>]])
<span class="co">#&gt; [1] -406.0072</span></code></pre></div>
<p>Convert to latitude and longitude, and height</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lat_lon_EB &lt;-<span class="st"> </span><span class="kw">n_E2lat_lon</span>(n_EB_E)
(latitude  &lt;-<span class="st"> </span>lat_lon_EB[<span class="dv">1</span>])
<span class="co">#&gt; [1] 0.9307209</span>
(longitude &lt;-<span class="st"> </span>lat_lon_EB[<span class="dv">2</span>])
<span class="co">#&gt; [1] 1.107728</span>

<span class="co"># height (= - depth)</span>
(height &lt;-<span class="st"> </span><span class="op">-</span>z_EB)
<span class="co">#&gt; [1] 406.0072</span></code></pre></div>
</div>
</div>
<div id="example-3-ecef-vector-to-geodetic-latitude" class="section level2">
<h2>Example 3: ECEF-vector to geodetic latitude</h2>
<p>Position <span class="math inline">\(B\)</span> is given as an “ECEF-vector” <span class="math inline">\(\mathbf{p}_{EB}^E\)</span> (i.e. a vector from E, the center of the Earth, to <span class="math inline">\(B\)</span>, decomposed in E).</p>
<p>Find the geodetic latitude, longitude and height (<code>latEB</code>, <code>lonEB</code> and <code>hEB</code>), assuming WGS-84 ellipsoid.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAAB4CAYAAACZ15x5AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAA7DAAAOwwHHb6hkAAApcElEQVR42u2de3zO5f/Hn5/73n3PDvfsZMsaY4Y1hCQ5RjmEKSl9VUSFvqiUQ/lhOURIkooOki+VQ6SSTE4hEtOUnJk5bGMHO59335/374+7TcPsvHv4PB+P+8Guz/W5rvfns73u6/C+rveliAgaGhpVg87WBmho3E5ogtPQqELsbnCtzH3NzMxMduzYQZcuXXBwcADg8uXLHD9+nPbt25e4jEuXLuHv78+uXbto2rQp7u7u18178OBB/v77bywWCwD+/v488MADRZb9119/YTKZ8Pf3r+z3q3H7olwvsVJauMTERB599FE+/vjjgrSTJ08yY8aMEpexc+dOPv/8cwCmTJlCZGRkkXkXL17M8uXLCQsLIywsjAkTJvDZZ58Vmf+LL75g8+bNlfHoGho3xK78RVyLqqo0a9aMjRs30qNHD5o0aYJOp8Pe3h4As9nM8uXL+f3332nTpg2DBw9GVVW++eYb0tLSOHz4MKdOneLixYt07twZNzc3du/ezaeffkqXLl0YMGAAinLlC8RoNDJ69Gj69OkDQHh4OK+99hrDhw8nLi6O+fPnk5iYyNChQ2ndujVGoxE7O+ujb9q0iXXr1uHj48O4ceNwdna29e9Eo4I5f/48a9eupXHjxvTq1avQ305VUyktnMViwcfHh9GjRzN9+nTy8vLQ6a5U9c4777Bu3To6derEt99+y6xZs1AUhffee4+wsDC6dOlC06ZNqVOnDr6+vqSkpLBjxw7atm3L7NmzOXjw4DV15ubmFvw/MjIST09P0tLSGDx4MAaDgVatWvHf//6Xv/76C6PRiMFgYPv27bz33nt069aN7OxsJkyYUNAt1bg1MJvNDBw4kLFjx9K3b182btxoU3sqpYUDyMnJITg4mPXr17N8+XLatGmDoijk5uayZcsWPvnkExo3bkzbtm0ZNmwYL774Im5ubowbN46goCAURcFgMBAUFATA6NGj6dy5M7/99htHjx7lnnvuKVRfSEgICxYsACA7O5t58+YRHh6Ovb0906dPByA9PZ1169ZhZ2eHoiisWrWKwMBA8vLyaNCgAfPnzycyMpKAgACb/lI0yo6IoOTkQFwcxMSQeOwYp/74A7CK7+TJk/Tu3dtm9lWa4MDatZwyZQojR47E2dkZOzs7cnJyyMvLK5gA8fLyQlEUsrOzcXFxwdHREYC8vDzMZjNg7TI6OTkBoNfrUVX1mrqGDx9Ojx49Csr08PBg9erVuLq6FuTx8/Nj165duLq6YrFYiIuLw2AwsGfPHvR6Pf3798dkMtnsl6FRDPk+45wcyMyEixchKgouXLB+zp61fqKiIC0NUlPxysmhB7AM6NChA/369bPpI1Sq4CwWC76+vgwePJipU6fSsGFDHB0dcXV1Zf/+/fTu3Ztff/0Vg8FQ8Iee37++WlTFOejr1q3LXXfdVSitYcOGLFq0iLS0NEwmE5s3b6ZZs2bExcWh1+tp1KgRtWrVYvz48VgsFhYvXlwwq6pRDUlIgNGj4fhxiI62iio7+4oQuXZqMAkIB/r378/y5cupUaOGTR+h0vxw/xbM448/TsOGDUlJSUGv1/PKK6/w1ltv8cgjjzB16lTGjBmDo6NjofFTnTp1+OGHH1i2bBl2dnYFglNV9Rrxqapa0Br+m7vvvptOnToRHBzMww8/TGxsLAMHDiQ7Oxuz2cxLL73E+vXrCQ4OpkuXLkRFRRW0pBrVEA8PqFcPDh60dhmzsgqJ7Xq8D8R4eDBlyhSbiw1AuUHLUWY/XE5ODmfOnCEwMLCgxbp8+TLx8fEEBgYCcOHCBSIiImjQoAF16tTBYrFw+vRp6tWrh729PaqqEh4ejpubW8EkjLOzM5GRkTg7O1OrVq2C+s6ePYvJZMLDw+O69vzxxx+kp6dz//33Y29vz7lz53BwcMDLy4vk5GT+/PNPXFxcrhkXalRD0tOhZ0/YvbvYrJeANsCgSZNK5ZKqIK47FVopgtPQqFTCwqBHD0hKumG2PKORvbNn02zIENzc3KraSk1wGrcQc+bAhAk3zvPUU7Biha0srLqVJhoalcrhw7Bz543zuLvDxIm2tvQaKnWWsqxcr9UVEVRVRa/XF3mfLVcQaFQBeXnIp5+iTJtmnbEsgs2AY+/edGja1NYWX0OFCS4vL4/c3Fzy8vLIyckhISGBxMREMjIyyMzMJCUlhezsbBITE8nNzSU+Pp68vDzi4+MLzU4mJCSQnZ19jXgsFgtZWVmYTKYiBens7Iybm1vBdQ8PjwK/npeXF0ajkVq1amE0GvH09MRoNBbkyf/ZYDBgNBpvKGwNG3DiBIwdi/LTT1fS7r8fWraEf63ZvQAMAZ50d6dDJZiRY8ljU1w4HTyC8DCW3mdbrOAyMjJIT08nPT2dxMREoqOjiYqKIioqqkBUKSkpJCcnk5SUREpKCllZWej1egwGAwD29vaICEajERHB1dUVk8mEyWTC1dUVEUFEcHR0pFGjRtfYoNPpiImJYefOnTz66KPXdXwrikJqaipJSUkoioKiKJw/f57s7GxEhLi4uAJnuqqqWCyWgn8tFgtmsxk3NzdcXV1xd3fHzc0NDw8P3Nzc8Pb2xsfHB19fX3x8fDCZTDg7O+Pk5FSwJlOjkrBY4IsvYNo0q+8NwGhEXn4ZJSQEMZlQzp2Df5ZszQXkjjt4+eWXK9yUbfGHmHpiFSfSogl74N2KFdyKFStYuHAhSUlJJCUlkZiYiKIoODs7YzKZcHFxwdnZGW9vbwICAnB3d8fLywtvb29cXFxwcXHB1dUVg8GAi4tLwb9Go7HQusqS8vfff5OQkMDcuXPL9LLyRZ2SkkJeXh6pqank5uaSnp5OZmYmycnJJCQkEBcXR1xcHLGxsZw/f57Dhw+Tnp5OWloa6enpZGRkULNmTdzc3HBzc8Pd3R1fX18aNGhA48aN8fX1pVatWtSqVUtbtVJeTp+GN96AdeuupDVrhsyejdKrF/DPzMS8eXDwIH9cvMgS4K3x42nQoEGFmXEsPYo5p75jRfQu8gxCbZ0LujIOX4oUnIuLC02aNKF+/fr4+vpSp04d3N3dC4mpLMIpK7m5uddt2UpKfquXPz3s5eVV4nvzu8SpqamkpKQQHR3NhQsXCj6RkZH89ttvXLx4kaysLFxcXDCZTLi5udGwYUMaNmxIYGAgfn5++Pv74+XlpbWMxfH119ZJj/PnrT/r9TBiBEyZguLpWThvYCBqSAjTR46kUYsWDBs2rEJMiM9JYWFkKB+dC+WyJR1UFXIVFGPZ5wqK/K0HBwcTHBxc+S/2JsDR0RFHR0dq165dZJ6MjAxSU1NJSEjg9OnTREREcPbsWc6ePcu6deu4cOECiqJgZ2eHq6srjRs3JjAwkICAAIKCgmjUqBEeHh4FW5huVyQyEmXyZFi58soqksaNkZkzUR5/vMj7cp99lsADBxjer1+5exZ5qoUV0buYc/o7juVeBIsKef982ZdzXk77mq0gnJyccHJyonbt2jRr1qzQtdzcXFJTU4mMjOTUqVNERERw9OhRtm3bxsqVK8nMzMRisRAQEEDjxo25++67uffee2nUqBFeXl63z3KztWtRXn8d8jcb6/Xw/PMwdSqKj88Nb63h5MScJUvKbYJZLIw49AlLLv4Cdjp8lZoE1KzNjsuHoQJmwTXBVQH5s6Kenp60bt260LXk5GQiIyOJiIjgwIEDhIeHs3TpUmbNmoWI4OfnR+PGjWnTpg1t2rQhICAAX1/fW8sFEh2NhISgLFtm7bYB1K8Pb78NAwZUqSlm1cKFrAScdEae9X6AkfV68uJfH4Neh4/BlbicFKQca0JumpUmf/zxBxMmTGDLli22NqXSSU1NJSYmhlOnThWEjTh27BgxMTG4ubnh4+NDmzZtuP/++2nevDl33XVXtViYWyZ++AHGj4dTpwqSZNAglOnTrQuVS/CudDpdhe7Uv5ybRlxOCneZfPkociMvH/8CV6nBxIaPE3J8JW4GJ/Y/MJc6Dp43Kua634haC1cNyZ+YCgwMLAgbkZycTHR0NPv27WPfvn0cOHCAFf8sW3J3d6dDhw60b9+edu3aERAQUP27obGx8NZb8OmnkL/Tw9fXOlZ79tkSF/Pqq6+SlJTE2rVrS+07FZHr9hQ8jCY8jCYuZCUw+9Q60CsMv7M7HT2DyBVzqeq4Gk1wNwmurq64urrSpEkTnn/+ecxmM4mJiYSHh7N37162b9/O5s2bSU1NxdfXl/vuu4+OHTvSoUMHGjZsWL1awI0bYdw4OHbsStqTT8LMmSil2G2/a9culi5dyoIFC8q0UOFqsV0twDmn1hGtpFAXN8Y17MuJtGhEsY7zyhxAOd8/dZ1PteLAgQPStWtXW5tRrYmNjZWtW7fKlClTpGPHjuLt7S12dnbSrFkzGTFihKxfv14uXLhgM/vUhASR114TsbcXsc5Bitxxh8jSpSKqWqqycnJypF27dtK6dWvJysqqcFv3Xj4ujusfFzY+LovOhIqIyJn0S9Jgy3/loT1vSlpesXVeV1ea4G5hoqOj5aeffpJRo0ZJixYtxGAwiKenp3Tp0kXeffddCQsLk7y8vKox5uefRW3Z8orQQNTgYJEjR8pU3OLFi0VRFNm8eXOlmHsw+Yx0/H2ydNr5uuSacwvSY7ISJTE3rSRFaIK7ncnOzpajR4/Khx9+KH379hVPT09xcHCQJk2ayIQJE+TXX3+VjIyMiq84JUVk0iRR/92qeXmJunChSBnFbrFYpE+fPvKf//ynQkzMNOdIpjnn2nem5kl01uWyFntdXWmzlLcpSUlJ7Nmzh59++onQ0FAuXbqEn58f3bp1o2/fvtx33324uLiUr5Jdu5Bx41DCwq6kde8O774LV/kqS0tiYiIiUuQu/5Kw8/IRPoncxNG0C6gIAY538JxfV4LvuBddeT3cN/sGVE1wlUdmZiYHDhwgNDSUDRs2cOrUKerUqUOvXr3o378/9957b+kmXdLSrOsb330XMjKsaR4eMGkSjBwJ1WA1zYqoXQwNX0BWXia+pjupoTNyOu08CgpvNRnMxEaPo5RPdNe/WbQupca/yMnJkYMHD0pISIg0a9ZMjEajBAYGyqRJk2T//v1isVhuXMC+fSKdOhUaq0mnTiIHDtj60QqIyrosXqGDhTXdZezhpRKXnSzJuRnyydmfxfB9X3H68T9yJPV8eavRxnAapSMrK0t2794tr7zyitSvX1+cnJykdevWMm/ePImMjLw6s8isWSIm0xWh1awpMmOGSGZmhdizadMmmTlzpmRnZ5ernJNp0dL395nSa+9bkpSbXpCeZzFLnZ+HCWt7yOro3eU1VxOcRtlJT0+XTZs2yfPPPy+enp5iMpmkX79+8uOPP0rqnj0iDz1UeAaybVuR33+v0PqbNm0qd911V/GtbAmxqIXL+TTyZzF+31dq/PC4HEg6Xez96o1dGZrgNCqGmJgYWbp0qXRq105qgDTQ6yUE5G8QcXcXeestkdTUCq1z/vz5YjAY5J577pFRo0bJ2bNnS3xvMcIQs2qRd06tE+P3fYV1vWX68W9ELaa84sqUInSlBRHSKDW1a9dmSMeO7PT0ZJ+i0N9i4RugA9DH05PN991HXgWubDl//jwzZ85k8ODB/PTTT7i4uPDII48we/ZsUlNTi72/uIXeCyNDeePwF5hFZUbBhMmNyyvz4nHRWjiN0mA2i3z0kYiX15UupL29JI8fLyu+/FIefPBBsbe3l6ZNm8r7778vMTEx5a5y5MiR4uLiUqhV+/vvv2XAgAHStm1bWb16dZHdzOJaosScNKn78zDh254y48SainxTWpdSo5ycPCny2GOFZyBbthTZurUgi6qqsnv3bnn22WfFxcVFPD095eWXX5bDhw+Xudqff/5Z1q5dW+S1Ll26SHBwsOzZs6fUZZ/LjBeXDU+Ld+iQ8ji5r4cmOI0ykpcnsnixiI9PoVZNXnpJJD6+yNsiIiJk6tSpUrduXXF0dJRBgwbJvn37Kty87Oxs+eyzz+Tee++VsWPHlmrFTLo5S1ZG7ZJvovdISt6N7yvBuO3faILTKANnz4r6xBOFW7WgIFF//LHERVy+fFkWLVokQUFBYm9vL3379pUdO3ZUuKkXLlyQgIAA2b9/f4nvOZ8ZL/U2Dxef0OdkZ0LZ1nUWgTZpolFKvv4aunRBWbvW+rNOB8OGwbZtKKWId+Pu7s6IESMICwtj6dKlXLx4kR49etCtWzc2b9583a0uKSkpHDp06LqnIhXF1q1bCQoK4u677y4yz9V1mUXlbGYcMZlxZFvyKv+ditbCaVzNuXMiTz1VuFVr3FjUb7+tkOLNZrOEhoZKt27dxM7OTh5++GH55ZdfCnXZpk2bJt7e3hIVFVWiMuPj46VVq1ayd+/eYvNmmrPlQlaCiIhkqbmy/uI++T7md4nLTq7It6h1KTWKQVVFvvlGxN//itD0epHBg0UuXqzw6iwWi2zYsEHatWsnRqNR+vXrJ/v375fjx4+LyWSSV199tcRO7okTJ8p///vf6z/WVV61xREbxHfrC/JRxMZrrlUgmuA0bkBUlMgLL4jY2V1ZLVKvnsiKFaXeHFpasrOzZeXKldKyZUtxcXGR+vXrS926deXy5ZLNGh47dkyaN29+XWf4p2d+lrZ7/k/Ckk5ZHzMzQer8PFQI7SejD34sIqWeDCkp2hhO4zqIwIYN0LUrLFlijS+iKMhTT6Hs2GE98qmSI4TZ29szYMAAfvvtN55++mkiIyOJi4tjwYIFxMfHF3v/zJkzefrpp/Hz87vq0YS1F39jb+4Zfo47CMDc099zgWR89e6Ma9wfqNpDYDTB3c7ExSEvvQSPPWY9NxvA1xeWLEH5+mu46g+4sqlRowatWrWiR48eTJo0iYULF9KmTRuWLl1Kdnb2de/ZunUrp0+fZsSIEde9rld0kKdi1Bk4nHqezy9sBYvwRsBj+DoU3ksnZY1TUhpE61LefqiqSGioqEFBV8ZqiiLSv79IRIStrSuIUXL27Fl58cUXxcHBQdq3by87d+4s1P3Lzs6Wbt26yZo1118hoqqqPPzbNGFzf5lxYo303/eOsLm/3L/rDcmx5EmumifZ/wqfcPW95UTrUmoAly9b40A+9hjK0aPWtDvugI8+sp4W6u9vawsLNrv6+fnxySef8Msvv2AymejevTtjx44lLi4OgC+//JIaNWrw2GOP3bhAs8oPl/axPi4MR4sd0wIHsD/5FA/ve4vev88gNif5mlsqq5uphcm7XRCBXbvgtdfgoHU8g6IgvXujzJkDQUE2NU9V1SIPh2nTpg0bNmxg6dKlvPnmm2zYsIEZM2bw+++/ExISUnyIPBHCUiJAp9CyRh2+PL+D1Rf3kOeoo1auA2nmLLztXavkObUW7nYgNRWZPBl6974iNg8PmDcP5bvvbC62AwcO0LNnTyIiIorMo9frGTp0KHv37qV169YMHDiQhIQEPD09S1aJKmBWOZR6lq8S9mBWVHo7Nye0bQgBTrVLVkYFoAnuFkd27oRu3VDeftsaX0RR4OGHYft2a2tn42OzLBYLb775JsePHy/RqTd+fn58/fXXrFmzhuPHj9OuXTtWrlxZsgkPnYJqp9CiRh1WtRjDD60n0KpmxZ0jVxI0wd2qpKdbIxkHB8P+/da0mjWtB2R89x3cYPlTVbJ+/XpCQ0N55513SnVm36OPPsru3bvp06cPzz77LC+88AKxsbHXz6xTwKjHx96dWQ2fYWeHmTx5Z3vrDGZVI9os5a3H77+LdOhQeAbygQesAX6qEcnJyRIUFCQPPfSQmM3mMpezcuVK8fX1lYYNG8qWLVsK0lVVlS67Q8R+43/kxT8/loiMS1X5eNpKk1uerCyROXNEXFyuiM3JyRryoDKCvJaTpUuXisFgqJAtO5GRkdK3b1+pUaOGhISEFLgW3jn9nexIKPtevHKgCe6W5sABUbt2LbzguG1bkV9/tbVlRRIfH3/NouXyYDab5aOPPhJHR0fp1auXnDlzxpaPp/nhbkny8pAFC5CuXVG2bgVAHBxg8mTYvBk6dLC1hUXi6elJ586dK8znpdfrGTVqFJs2beLUqVM8+OCD1S5wsCa4m5kjR6BfP5RXX0VJTramtWyJsmGD9ey1Cjyk8GaiY8eO7Nixg+bNmxMcHMycOXNQ809WtTGa4G5GzGZk4UJ48EHrwmOAGjWsZ65t3WpNr6ZkZGSwbNmygtUilYWPjw9r1qxh8uTJTJo0iaFDh5Kenm7rx9fGcDcdJ0+KPP544bFa06YimzbZ2rISsWTJEgFk+/btVVbnmjVrxGQySffu3SU6OrqqqtUmTW5qLBaRL74oHMjHYBAZNeqGgXyqE/Hx8VK3bl157LHHyuUGKAt79uyROnXqyN133y1HyngmXSnRJk1uWiIjYdAgeP55iImxpjVuDGvXWhcdl3R5k42ZP38+sbGxzJgxo0xHBJeHdu3asX37dgwGA127dmXXrl22eQmitXDVF4tF5KuvRPz8rrRqdnYiQ4eKVF3XqEIIDw8XvV4vEydOtKkdCQkJ0rNnT6lZs6ZsqtxuuNbC3VRER1tbtIED4dw5a1r9+rBqFSxeDD4+trawVBiNRoYMGcIrr7xiUzs8PDxYs2YNPXr04IknnuCHH36oWgNEa+GqF6oqsnatSMOGhZdmDRwocvURURplJjMzUwYNGiT29vayevXqyqjiurrS9sNVJ2JjkZAQlCVLIN9v5OcHM2fCM8/Y2rpbCgcHBz7//HMcHBwYNGgQqqoyYMCASq9XE1x1QAR++gl5/XWUY8esaYoC/frBnDnQoGq3kFQk8fHxeHh4FLm51JYYjUYWLlyIoii88MILuLm50aNHj0qts/q9hduNy5fhlVfg8ceviK12beSzz6zjtZtYbBcvXqRz586sWrXK1qYUiZ2dHfPnz6d379489dRT7M/fylRJaIKzFSKwbRt062ad2s/NtbZqffog27ahDB1q882h5WXOnDmcP3+eVq1a2dqUG+Lg4MCSJUu49957eeKJJzieH8GsEtAEZwuSkqyBfP4d8sDbGz78EL77DuWuu2xtYbkJDw9n0aJFTJw4kcaNG9vanGIxmUx89dVXeHl50bdvXy5evFgp9WiCq2p27bK2avPmQU6OtVXr3t0a8mDUKKhih3BlkJOTw8SJE/H392fkyJG2NqfEeHl5sWbNGrKyshg6dGiRsTDLgya4KkJSUmDKFAgOhj/+sCa6u8M778D339s8kE9FEhERwZEjR5g2bRo1a9a0tTmlon79+ixfvpxt27YxderUiq9AND9c5bNvn6j331/Yr9a5s8gff9jaskpBVVU5d+6c5OTk2NqUMrN48WJRFEWWLVtW1iI0P1yVk5kJ778Pc+ag5B/+7uKCjB8PY8agODra2sJKQVEU6tata2szysXQoUP5+++/GTVqFE2bNuWee+6pkHK1LmVlERYGPXvCpEmQL7YOHWDLFpTJk29Zsd1KzJ49mxYtWjBs2DDS0tIqpExNcBVNdjbMn488/LB1ggQQJyeYONG6WfS++2xtYaUxe/ZsNm3aZGszKgwHBwc+/vhjTp48yaxZsyqmUNHGcBXHX3+J2r174c2h990nsnOnrS2rdHbs2CGAzJs3z9amVDiLFi0SnU4n27ZtK81t2gbUSiMvT+Sjj0Q8Pa8IrUYNkTFjRFJSbG1dpZOdnS0dOnSQli1bSkY1DMdXXsxmszzyyCMSEBBQ4kMiRdueU0kcOYL06wcvvQQJCda0e+6BH3+0+tpcXGxtYaWzcuVKdu/ezaxZs3C8Bcemer2eDz74gMuXL/POO++UrzDRWriyYbGILFki4u1dKOSBOnKkSMm/BW964uPj5c4775T+/ftXediEqmbevHni6Ogohw+XKLCs1sJVGKdPw3/+Ay+8APnx7IOCYN06lIULrQ7t2wQnJyfeeOMNpk2bVuVhE6qa4cOH4+/vz+TJk8sedk+0Fq7kqKrI//4n4ut7pVXT60V98UWR2FhbvyKNKuDHH38UQDZs2FBcVq2FKxfnzsHgwTBkCERFWdMaNoRVq1A++QRKcfKLxs1Lz5496dOnD5MnTy7TWktNcMUhAitXQufO8OWX1jRFQYYMgV9+gSeesLWFNuHkyZNE5X/x3Ebo9XomTpzI0aNHyxRGXRPcjYiJgRdftIY3OHvWmubnhyxfjrJ0Kdx5p60ttAmZmZk8+eST/N///V/JDkK8xWjTpg0PPfQQs2fPxmw2l+peTXDXQwTWrbOGDF+82PqzosDTT8Mvv6AMHGhrC23Kp59+ytGjRxk6dGilHT5fnVEUhXHjxrF3795Sr6zRBHcVEh9v9an17w8nTlgTfXxgyRL4+mtrqLrbmPPnz/P2nuU8MOlpHnjggRLfp6oqF3OSiMi8RLI546ZvGTt37sxDDz3EvHnzSvUsmuDyEUFCQ1EefBAWLbJGzcoP5LNjBzz3nK0ttDmqqvLW1x+Q0O9O9rY3M+7I/8gwFz9xsDPhCMFhM7lnx1iabRtN61/H8+qRJcRkJ9r6kcqMTqdj1KhR/Pbbb/z1118lv8/WhlcLEhOt22UefRQOH7ameXtbY4188411NlKDrKwsYt3NKDXtycjJYt6FDTwTPp+E3NQi79kcd5DeYTMITT6Eh8FEd68WZOXm8sHFzfTdN4uEnNRSWFC96Nq1K7Vr1+arr74q8T23t+BErKENuna17lvLy7O2ar17WwP8jBx5S4Q8qCicnJz49oV3Wd18DHXtPUEVfkj8gyfC3iEm69rWyiwWJh77mgxHYaBne/Z2msP3bf6PPR1n0VjvRVjeOVZG/2rrxyozzs7OPPPMM6xevZrk/PP5iuH2FVxqKkyYAL16XQnk4+ZmFd7330OTJra2sFpisLOjv297NrUJ4R7n+qDCzrTjDPnzA9LMWYXyWkTlSZ/2vOD2AJMC+2OyqwGAn2Mt6jt4gU7hdEblBOupKp5++mliY2PZsWNHifLfnoLbvRseftgaTyQ/kE/XrrBlizVG5E0enq4yuHpi4C6TL+vufYP7nBuAwJbEvxl35H+oXMlnrzPwesPH+PzuEQQ6XXGhrInZw69JxyDHQluPQFs/Wrlo1KgRzZs3Z/369SXKf3sJLi3NGsinRw/Yu9eaVrMmzJ5t3RxazeMn2orZs2czZswYcnNzC6X7OdZiVauxNDR6g6Lw2YUt/O/8thuWtTByI8+Ev0+GLo8RtbvxRO22tn68cmEwGAgODmbHjh0lOmH19hHc/v1I794wfbo11oiiQMeO8PPP8PrrYG9vawurJSdPnmTGjBmYzWbsrtPy13fy4osWL1FT7wA6hclHV3A6/frdxHUxv/Pq0aXkKRbeqPMoH7QYhp1y84+Re/bsSUxMDIcOHSo2760vuIwMePtt6N4d5dd/BugmEzJ9OoSGQps2pSru6sWotzpTp07F1dWVKVOmFHk+QAePuxhX7xEALpLKlBMrr5vv83NbMDvoeLluL2Y3GYTdLfLn16RJE3x9fdm+fXuxeW/twcpff8HYsdYZx3+Q1q1R3n0XpVOnUhe3adMm5s6dW2h1RceOHZkyZUq5TT1y5AinTp2ib9++tn5rBWzbto2VK1fy2Wef4VnMKauvNAjmu0v7CM88y/eX9hOWdIrWboXdKSqCj1KTR2q3tvWjVShOTk4EBQURFhZWbN5bUnCSk4OyaBHMmGH1sQE4OiKjR1tnJsu4C/vMmTPUr1+fUaNGFaS5ubkV/D8lJQV7e3t0Oh16vZ7c3Fzs7OwwGAzk5uYiItjb2yMiJP5jl/s/e+dCQ0OJjo6mZ8+e2Nvbk5ubS1paGm5ubuh0OlRVLRhDZWRkFKRXFqqqMnfuXFq3bs2gQYOKze9i58AbDfsx4OA8MvVmFpzZwFetXiuU59UGfYjPSaG+g3el2W0r2rdvz8KFC8nIyMDJyanIfLee4I4cQRkzBjZvvpLWsiW89x5K587lKlqn0xEQEEDLli2vubZ69WrmzJlDvXr1MJvNvPXWWyxbtowOHTrQr18/Fi9eTHp6Oq+99hohISH88ssvgNV5+vLLL7Ny5UouXbpEt27d8PX1Zfz48SQlJVGnTh3mz59PzZo1GTFiBCkpKZhMJpYuXYqDg0OlvUZFUZgzZw46nY4aNWqU6J5H72hNa1MD9mecITTuIJEZsdR3uiKuKcdW8qf5AnPrD+QV/96VZrstaNWqFfHx8URGRtK0adMi890anWiwnj6zaBE89NAVsTk4wJgxsHWrdXtNOTEYDHz55Zc8+eSTBZ8ff/yRtLQ0FixYwOLFiwkJCeHgwYNYLBZSU1PJyrL6ptLT08nKyuLo0aNkZ2ezc+dOFixYwJo1a8jMzOTFF19kyJAhdOvWjcmTJ/PUU0+xc+dOmjVrxrRp01AUhT///JPhw4fz5ZdfVqrYwCq45s2b06xZsxLfY68z8NSdHQEhUTL4KfZAoes6nY5bddhbv359HBwcOHny5A3z3Rot3MmT1tNo/u0LCQqC996zugAqCIvFQosWLRj4r90CgYGBHD9+HCcnp4JjmTp37kxeXh46na5gvJffLQwMDMTZ2Zk+ffpgNpvJyclBVVWMRiP29vakpaWRlJREv379cHBw4LnnnisIROrr60ubNm0wGAy2fuNF0su7FW8eX0maLpcNl/5gpH8vdFjfwbKWr5BmzqKOg2c5a6l++Pj44ODgwNn8bVxFcHMLTlWRZctQJk+27l0Dq9N6+HCrv62Cd2GrqkqTJk3o2bNnofTU1NRCMS7y90iJSEGcD0VRsLe3Z82aNRw9epQFCxbg7e3NE088UZBfr9djMBgQkYLy/r3fqkaNGpUeN+TYsWOcOnWK3r17l6muBk53cK9rA35JO8bfaedIykvHw2ACoJGzT6XabkscHByoV68eJ/J3mBTBzdulPH0aBgxAef75K2ILDES+/RYWLqyUkAeqqnLhwgVOnDhR8ImMjMTf3x+j0cjy5cvZuHEje/bswWg0Uq9ePUJDQwkPD2fdunWA9SgnOzs7HBwc+Pbbbzl06BBpaWkoikJERAQWiwV/f3/ee+89Tpw4wcyZM2nZsiVOTk7k5eVVqitCVVXGjBnD+PHjyczMLFMZekVHU5e6IBCbk8yZjNhKs7e6ERAQUGwLd1MJTq/XXwl50KULrFljvWBnB88/D9u2oTzySKXVX6dOHQ4dOsTQoUMLPiEhIdjb2/P++++zatUqVqxYQVBQEDk5OQwfPpykpCSmTZtGnz59qF27Nk8++SRubm4MHjyY5ORkXnrpJdLT0+nUqRPnzp1j8+bNzJ07l6ioKIYOHYqHhweTJ09Gp9PRpEmTSu1Orl+/nk2bNjF16lRMJlOZy2lZswGogkUnnEyPqTR7qxvu7u6kpKTcOJPcJFG7/vzzT+l7zz0iw4aJ6HRXomY1aCCydq2tzSvEc889J7/++qutzSgVaWlpEhQUJN26dROLxVKusrYlHBJ+7CeEPi4fnt1o60erMqZPny6NGzfOf39lO64qOTm51HEbKgNTQgLzw8MhPNz6RQFc7t4d3n4b+0aNyMmPelwNSEtL4/LlyyRUI5uK45NPPuHo0aPMnTu3wEdY9heQCzlmsOg4fzGKBKeb5z2UB51OR3p6OqqqFukjVaToMYEADBs2rERrxCobychg4pEj9AXSPDx418WFTbVqYWdnVy2+EP5NWloa9vb2GI1GW5tSYhITExERPD09yz1ONOsh2VVF0vNwyBSc9SXz493sxMXFodPpOHHiBHZ2dtcN9lKs4HJzc7FYLLZ+Fg4dOkTI00+zuVcvLKNHo/r5oapq2SPgViJ6vR5VVW+qtZZ6vR5FUbBYLOW2W1GUghnO6vo7qgw++OADFixYwPnz54sUXLFdyuryLW1nZwcNGsCHH6IHbv415tWT6uzjq+7k+1pvmMfWRpaGm6nF0Lj9MJvNGAyGG4YOvKkEp6FRnUlISKBWrVo3XFSuCU5Do4KIi4vD29tba+E0NKqC/BbuRmiC09CoIKKioqhdu/YN82iC09CoAOLj44mNjaVRo0Y3zHfTCO7fO541NKobERERZGdnExQUdMN8N43g3N3defDBB21thobGdYmPj8fJyQl/f/8b5it2pYmGhkbxZGRkkJiYyJ133pnvFij10i4NDY0K5qbpUmpo3ApogtPQqEI0wWloVCH/D4Gt69cFSjHvAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTAyLTA3VDE3OjExOjIxKzAxOjAwz4Hb9wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wMi0wN1QxNzoxMToyMiswMTowMI80edYAAAAASUVORK5CYII=" alt="ECEF-vector to geodetic latitude." width="220px" />
<p class="caption">
ECEF-vector to geodetic latitude.
</p>
</div>
<p>Position <span class="math inline">\(B\)</span> is given as <span class="math inline">\(\mathbf{p}_{EB}^E\)</span>, i.e. “ECEF-vector”</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(p_EB_E &lt;-<span class="st"> </span><span class="fl">6371e3</span> <span class="op">*</span><span class="st"> </span><span class="kw">c</span>(<span class="fl">0.9</span>, <span class="op">-</span><span class="dv">1</span>, <span class="fl">1.1</span>)) <span class="co"># m</span>
<span class="co">#&gt; [1]  5733900 -6371000  7008100</span></code></pre></div>
<div id="solution-2" class="section level3">
<h3>Solution</h3>
<p>Find n-vector from the p-vector</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">l &lt;-<span class="st"> </span><span class="kw">p_EB_E2n_EB_E</span>(p_EB_E)
(n_EB_E &lt;-<span class="st"> </span>l[[<span class="st">'n_EB_E'</span>]])
<span class="co">#&gt; [1]  0.5170890 -0.5745433  0.6344439</span>
(z_EB &lt;-<span class="st"> </span>l[[<span class="st">'z_EB'</span>]])
<span class="co">#&gt; [1] -4702060</span></code></pre></div>
<p>Convert to latitude and longitude, and height</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lat_lon_EB &lt;-<span class="st"> </span><span class="kw">n_E2lat_lon</span>(n_EB_E)
(latEB  &lt;-<span class="st"> </span>lat_lon_EB[<span class="dv">1</span>])
<span class="co">#&gt; [1] 0.6872888</span>
(lonEB &lt;-<span class="st"> </span>lat_lon_EB[<span class="dv">2</span>])
<span class="co">#&gt; [1] -0.8379812</span>

<span class="co"># height (= - depth)</span>
(hEB &lt;-<span class="st"> </span><span class="op">-</span>z_EB)
<span class="co">#&gt; [1] 4702060</span></code></pre></div>
</div>
</div>
<div id="example-4-geodetic-latitude-to-ecef-vector" class="section level2">
<h2>Example 4: Geodetic latitude to ECEF-vector</h2>
<p>Find the ECEF-vector <span class="math inline">\(\mathbf{p}_{EB}^E\)</span> for the geodetic position <span class="math inline">\(B\)</span> given as latitude <span class="math inline">\(lat_{EB}\)</span>, longitude <span class="math inline">\(lon_{EB}\)</span> and height <span class="math inline">\(h_{EB}\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Geodetic latitude to ECEF-vector." width="220px" />
<p class="caption">
Geodetic latitude to ECEF-vector.
</p>
</div>
<div id="solution-3" class="section level3">
<h3>Solution</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lat_EB &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">1</span>)
lon_EB &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">2</span>)
h_EB &lt;-<span class="st"> </span><span class="dv">3</span></code></pre></div>
<p><strong>Step 1</strong>: Convert to n-vector</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(n_EB_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(lat_EB, lon_EB))
<span class="co">#&gt; [1] 0.99923861 0.03489418 0.01745241</span></code></pre></div>
<p><strong>Step 2</strong>: Find the ECEF-vector p_EB_E</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(p_EB_E &lt;-<span class="st"> </span><span class="kw">n_EB_E2p_EB_E</span>(n_EB_E, <span class="op">-</span>h_EB))
<span class="co">#&gt; [1] 6373290.3  222560.2  110568.8</span></code></pre></div>
</div>
</div>
<div id="example-05" class="section level2">
<h2>Example 5: Surface distance</h2>
<p>Given two positions <span class="math inline">\(A\)</span> <span class="math inline">\(\mathbf{n}_{EA}^E\)</span> and <span class="math inline">\(B\)</span> <span class="math inline">\(\mathbf{n}_{EB}^E\)</span>, find the surface distance <span class="math inline">\(s_{AB}\)</span> (i.e. great circle distance). The heights of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are not relevant (i.e. if they don’t have zero height, we seek the distance between the points that are at the surface of the Earth, directly above/below <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>). Also find the Euclidean distance (chord length) <span class="math inline">\(d_{AB}\)</span> using nonzero heights.</p>
<p>Assume a spherical model of the Earth with radius <span class="math inline">\(r_{Earth} = 6371~\mathrm{km}\)</span>.</p>
<p>Compare the results with exact calculations for the WGS-84 ellipsoid.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Surface distance." width="220px" />
<p class="caption">
Surface distance.
</p>
</div>
<div id="solution-4" class="section level3">
<h3>Solution</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EA_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">88</span>), <span class="kw">rad</span>(<span class="dv">0</span>));
n_EB_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">89</span>), <span class="kw">rad</span>(<span class="op">-</span><span class="dv">170</span>))
r_Earth &lt;-<span class="st"> </span><span class="fl">6371e3</span></code></pre></div>
<div id="spherical-model" class="section level4">
<h4>Spherical model</h4>
<p>The great circle distance is given by equations (16) in <span class="citation">(Gade <a href="#ref-gade2010">2010</a>)</span> (the <span class="math inline">\(\arccos\)</span> is ill conditioned for small angles; the <span class="math inline">\(\arcsin\)</span> is ill-conditioned for angles near <span class="math inline">\(\pi/2\)</span>, and not valid for angles greater than <span class="math inline">\(\pi/2\)</span>) where <span class="math inline">\(r_{roc}\)</span> is the radius of curvature, i.e. Earth radius + height:</p>
<p><span class="math inline">\(\begin{align} s_{AB} &amp; = r_{roc} \cdot \arccos \!\big(\mathbf{n}_{EA}^E \boldsymbol{\cdot} \mathbf{n}_{EB}^E\big)\\  &amp; = r_{roc} \cdot \arcsin \!\big(\big|\mathbf{n}_{EA}^E \boldsymbol{\times} \mathbf{n}_{EB}^E\big|\big) \tag{16} \end{align}\)</span></p>
<p>The formulation via <span class="math inline">\(\operatorname{atan2}\)</span> of equation (6) in <span class="citation">(Gade <a href="#ref-gade2010">2010</a>)</span> is instead well conditioned for all angles:</p>
<p><span class="math inline">\(s_{AB} = r_{roc} \cdot \operatorname{atan2}\big(\big|\mathbf{n}_{EA}^E \boldsymbol{\times} \mathbf{n}_{EB}^E\big|,  \mathbf{n}_{EA}^E \boldsymbol{\cdot} \mathbf{n}_{EB}^E\big) \tag{6}\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(s_AB &lt;-<span class="st"> </span>(<span class="kw">atan2</span>(base<span class="op">::</span><span class="kw">norm</span>(pracma<span class="op">::</span><span class="kw">cross</span>(n_EA_E, n_EB_E), <span class="dt">type =</span> <span class="st">&quot;2&quot;</span>),
                pracma<span class="op">::</span><span class="kw">dot</span>(n_EA_E, n_EB_E)) <span class="op">*</span><span class="st"> </span>r_Earth))
<span class="co">#&gt; [1] 332456.4</span></code></pre></div>
<p>The Euclidean distance is given by</p>
<p><span class="math inline">\(d = r_{roc} \cdot \big| \mathbf{n}_{EB}^E - \mathbf{n}_{EA}^E \big|\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(d_AB &lt;-<span class="st"> </span>base<span class="op">::</span><span class="kw">norm</span>(n_EB_E <span class="op">-</span><span class="st"> </span>n_EA_E, <span class="dt">type =</span> <span class="st">&quot;2&quot;</span>) <span class="op">*</span><span class="st"> </span>r_Earth)
<span class="co">#&gt; [1] 332418.7</span></code></pre></div>
</div>
<div id="elliptical-model-wgs-84-ellipsoid" class="section level4">
<h4>Elliptical model (WGS-84 ellipsoid)</h4>
<p>The distance between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> ca be calculated via <code>geosphere</code> package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">geosphere<span class="op">::</span><span class="kw">distGeo</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">88</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">170</span>, <span class="dv">89</span>))
<span class="co">#&gt; [1] 333947.5</span></code></pre></div>
</div>
</div>
</div>
<div id="example-6-interpolated-position" class="section level2">
<h2>Example 6: Interpolated position</h2>
<p>Given the position of <span class="math inline">\(B\)</span> at time <span class="math inline">\(t_0\)</span> and <span class="math inline">\(t_1\)</span>, <span class="math inline">\(\mathbf{n}_{EB}^E(t_0)\)</span> and <span class="math inline">\(\mathbf{n}_{EB}^E(t_1)\)</span>.</p>
<p>Find an interpolated position at time <span class="math inline">\(t_i\)</span>, <span class="math inline">\(\mathbf{n}_{EB}^E(t_i)\)</span>. All positions are given as n-vectors.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Interpolated position." width="220px" />
<p class="caption">
Interpolated position.
</p>
</div>
<div id="solution-5" class="section level3">
<h3>Solution</h3>
<p>Standard interpolation can be used directly with n-vector as</p>
<p><span class="math display">\[
\mathbf{n}_{EB}^E(t_i) = \operatorname{unit}\Bigg(\mathbf{n}_{EB}^E(t_0) + \frac{t_i − t_0}{t_1 − t_0} \Big(\mathbf{n}_{EB}^E(t_1) − \mathbf{n}_{EB}^E(t_0)\Big)\Bigg)
\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EB_E_t0 &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="fl">89.9</span>), <span class="kw">rad</span>(<span class="op">-</span><span class="dv">150</span>))
n_EB_E_t1 &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="fl">89.9</span>), <span class="kw">rad</span>(<span class="dv">150</span>))

<span class="co"># The times are given as:</span>
t0 &lt;-<span class="st"> </span><span class="dv">10</span>
t1 &lt;-<span class="st"> </span><span class="dv">20</span>
ti &lt;-<span class="st"> </span><span class="dv">16</span> <span class="co"># time of interpolation</span></code></pre></div>
<p>Using the expression above</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t_frac &lt;-<span class="st"> </span>(ti <span class="op">-</span><span class="st"> </span>t0) <span class="op">/</span><span class="st"> </span>(t1 <span class="op">-</span><span class="st"> </span>t0) 
(n_EB_E_ti &lt;-<span class="st"> </span><span class="kw">unit</span>(n_EB_E_t0 <span class="op">+</span><span class="st"> </span>t_frac <span class="op">*</span><span class="st"> </span>(n_EB_E_t1 <span class="op">-</span><span class="st"> </span>n_EB_E_t0) ))
<span class="co">#&gt; [1] -0.0015114993  0.0001745329  0.9999988425</span></code></pre></div>
<p>and converting back to longitude and latitude</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(l  &lt;-<span class="st"> </span><span class="kw">n_E2lat_lon</span>(n_EB_E_ti) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">deg</span>())
<span class="co">#&gt; [1]  89.91282 173.41322</span>
(latitude  &lt;-<span class="st"> </span>l[<span class="dv">1</span>])
<span class="co">#&gt; [1] 89.91282</span>
(longitude &lt;-<span class="st"> </span>l[<span class="dv">2</span>])
<span class="co">#&gt; [1] 173.4132</span></code></pre></div>
</div>
</div>
<div id="example-7-mean-position-centermidpoint" class="section level2">
<h2>Example 7: Mean position (center/midpoint)</h2>
<p>Given three positions <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span>, and <span class="math inline">\(C\)</span> as n-vectors <span class="math inline">\(\mathbf{n}_{EA}^E\)</span>, <span class="math inline">\(\mathbf{n}_{EB}^E\)</span>, and <span class="math inline">\(\mathbf{n}_{EC}^E\)</span>, find the mean position, <span class="math inline">\(M\)</span>, as n-vector <span class="math inline">\(\mathbf{n}_{EM}^E\)</span>.</p>
<p>Note that the calculation is independent of the depths of the positions.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAANwAAAB4CAMAAACuCWxLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JQAAgIMAAPn/AACA6QAAdTAAAOpgAAA6mAAAF2+SX8VGAAAA/1BMVEX/////////8/P/k5P/YGD/MDD/CAjB7NRLx4Mku2kAsFAZuGFYy4zc9Of/t7f/ICD/AAD/HBz/s7Nkz5UMtFj/eHj/ZGT/nZ3/Ozv/gYE+w3syv3L/r6//p6f/SEj/Zmb/4+P/EBD/HR3/zc3/4uL/V1ec4Lv/j4//Dg7/rKz/VFT/c3P/u7uM27D/Kytw052t5sf/q6v/n5//aGj/XFz/7+/z+/eT3rVgzpIwv3EIslW36c4gumYcuWOz58t41aKv5sin5MPj9uwQtVuP3LJUyoqr5cWf4b1o0JdczY/v+vT/19f/fHz/TEz/FBT/UFD/g4P/DAz/+/v/i4v/RESFJMg9AAAAAXRSTlMAQObYZgAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAHdElNRQfjAgcRCzUTsHz6AAADhElEQVR42u2ba1vTMBiGKYMNi2gmKh3igK11Gx0VFTmok7OncRz+/99i0rS2HWFX20RJez33l9HQlN70zelNNzUFAAAAAAAAAAAAAAAAQAcMjZiuzMxWZ2cq04LfaSRXm3tkmvOPFzJVevKUcOrPtJZbNH2e1zLUeUEiXgZlS/zQamglN1czasum+Sp9lRUS5zUvbIbHq5JykyI+Fwv02aUOzLX1hNz6ml/aIqRt2A4tkJObGPH5oHJv0p7bIUk6rNAmpEs/erJyoohX8ORSN7qNMbkNVkibXJOLWzJywoiXg7W5+dRn18fk6qzQJcSlil3S7UvIiSNehk2/u9yUk7OCA68t01sKI14KNhgsp25x94RlNzyyZOSEl5aVW8xyvujf2yakZfDBriEhJwwKKWhYvs1yvqhhBP0Ji05XK7kt09zKVOFd4gbesyLen0jLqQ/L7HyI/f1tI5Dq0Q+bNr2eVh3KZpaukrMSxk89GIqolE2HcI9Fp4Sc+qEga4fCCCeAH/lh++/9NG2pibMg4v/7kxunz2+m5bDYlJETRLxeSMndjXgpdnb39j/t7+3u6CE3HvFSfP7CV6vm4Ksecgo5MCMydyuayx2acY5KJXd8kpA7OS6T3KmZ5LRMcmdjcmdlkhuMyQ0g9+/kbDo5JX1FcrqFpcumJkuK5DTrUGw/WeEqktNsKHAIoQtDR5Gc8S0h913JNXPLsURMj6WYVPEj5vZTzSVzy9Gn1mErQ2VyxmHYYw6OFF0xr1zPz6ARf02vinDJ80vVBfPKeX7OxOPZGF3JKdfhWymWirSQdnItPgi46sYCfeTcKHfSfGgD1XJ2N5LzHtpAtdxqOL71lY4FesgRtuvsE/2kIznlGkF1T926QBe5h75pyEEOcnoCOchpCOR0kRueX1zWr66HZZSr3PCFSDXtArlActuxReSoZHKV+KsTt+WSG97E5apRu7M77CVEyxWk4Qojd558Xek6LO+3gpLG3TqFkbtIyl2Fbl3aAtv08bUE68rCyF0KXxFk2Zz7tysKLudMzFAVRk4YlvbkHcLCyAk7lCDxXXi5YVUwFDQnJ4ULI5d8dzUYxK3J6fziyEVfQCLk96hscqPbIDKrt+HUsjxygiWPw79EUAq5O7CvWjn+/ES4B1psOfboOMIdi4LLGb0mnYB5jnjzOpccAAAAAAAAAAAAAAAAANX8AaqFmzvu6+6cAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE5LTAyLTA3VDE3OjExOjUzKzAxOjAwUtvDxwAAACV0RVh0ZGF0ZTptb2RpZnkAMjAxOS0wMi0wN1QxNzoxMTo1MyswMTowMCOGe3sAAAAASUVORK5CYII=" alt="Mean position (center/midpoint)." width="220px" />
<p class="caption">
Mean position (center/midpoint).
</p>
</div>
<div id="solution-6" class="section level3">
<h3>Solution</h3>
<p>The (geographical) mean position <span class="math inline">\(B_{GM}\)</span> is simply given equation (17) in <span class="citation">(Gade <a href="#ref-gade2010">2010</a>)</span> (assuming spherical Earth)</p>
<p><span class="math display">\[
\mathbf{n}_{EB_{GM}}^E = \operatorname{unit}\Big( \sum_{i = 1}^{m} \mathbf{n}_{EB_i}^E \Big) \tag{17}
\]</span></p>
<p>and specifically for the three given points</p>
<p><span class="math display">\[
\mathbf{n}_{EM}^E = \mathrm{unit}\Big(\mathbf{n}_{EA}^E + \mathbf{n}_{EB}^E + \mathbf{n}_{EC}^E \Big) = \frac{\mathbf{n}_{EA}^E + \mathbf{n}_{EB}^E + \mathbf{n}_{EC}^E}{\Big | \mathbf{n}_{EA}^E + \mathbf{n}_{EB}^E + \mathbf{n}_{EC}^E \Big| }
\]</span> Given the three n-vectors</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EA_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">90</span>), <span class="kw">rad</span>(<span class="dv">0</span>))
n_EB_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">60</span>), <span class="kw">rad</span>(<span class="dv">10</span>))
n_EC_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">50</span>), <span class="kw">rad</span>(<span class="op">-</span><span class="dv">20</span>))</code></pre></div>
<p>find the horizontal mean position</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(n_EM_E &lt;-<span class="st"> </span><span class="kw">unit</span>(n_EA_E <span class="op">+</span><span class="st"> </span>n_EB_E <span class="op">+</span><span class="st"> </span>n_EC_E))
<span class="co">#&gt; [1]  0.38411717 -0.04660241  0.92210749</span></code></pre></div>
<p>and convert to longitude/latitude</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(l  &lt;-<span class="st"> </span><span class="kw">n_E2lat_lon</span>(n_EM_E) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">deg</span>())
<span class="co">#&gt; [1] 67.236153 -6.917511</span>
(latitude  &lt;-<span class="st"> </span>l[<span class="dv">1</span>])
<span class="co">#&gt; [1] 67.23615</span>
(longitude &lt;-<span class="st"> </span>l[<span class="dv">2</span>])
<span class="co">#&gt; [1] -6.917511</span></code></pre></div>
</div>
</div>
<div id="example-8-a-and-azimuthdistance-to-b" class="section level2">
<h2>Example 8: A and azimuth/distance to B</h2>
<p>Given a position <span class="math inline">\(A\)</span> as n-vector <span class="math inline">\(\mathbf{n}_{EA}^E\)</span>, an initial direction of travel as an azimuth (bearing), <span class="math inline">\(\alpha\)</span>, relative to north (clockwise), and finally the distance to travel along a great circle, <span class="math inline">\(s_{AB}\)</span> find the destination point <span class="math inline">\(B\)</span>, given as <span class="math inline">\(\mathbf{n}_{EB}^E\)</span>.</p>
<p>Use Earth radius <span class="math inline">\(r_{Earth}\)</span>.</p>
<p>In geodesy this is known as “The first geodetic problem” or “The direct geodetic problem” for a sphere, and we see that this is similar to <a href="#example-02">Example 2</a>, but now the delta is given as an azimuth and a great circle distance. (“The second/inverse geodetic problem” for a sphere is already solved in <a href="#example-01">Examples 1</a> and <a href="#example-05">5</a>.)</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="A and azimuth/distance to B." width="220px" />
<p class="caption">
A and azimuth/distance to B.
</p>
</div>
<div id="solution-7" class="section level3">
<h3>Solution</h3>
<p>Given the initial values</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EA_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">80</span>),<span class="kw">rad</span>(<span class="op">-</span><span class="dv">90</span>))
azimuth &lt;-<span class="st"> </span><span class="kw">rad</span>(<span class="dv">200</span>)
s_AB &lt;-<span class="st"> </span><span class="dv">1000</span> <span class="co"># distance (m)</span>
r_Earth &lt;-<span class="st"> </span><span class="fl">6371e3</span> <span class="co"># mean Earth radius (m)</span></code></pre></div>
<p><strong>Step 1</strong>: Find unit vectors for north and east as per equations (9) and (10) in <span class="citation">(Gade <a href="#ref-gade2010">2010</a>)</span></p>
$$
<span class="math display">\[\begin{align}
\mathbf{k}_{east}^E  &amp; =   \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \times \mathbf{n}^E \tag{9} \\

\mathbf{k}_{north}^E &amp; =  \mathbf{n}^E  \times  \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}  \times \mathbf{n}^E \tag{10}
\end{align}\]</span>
<p>$$</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k_east_E &lt;-<span class="st"> </span><span class="kw">unit</span>(pracma<span class="op">::</span><span class="kw">cross</span>(base<span class="op">::</span><span class="kw">t</span>(<span class="kw">R_Ee</span>()) <span class="op">%*%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.vector</span>(), n_EA_E))
k_north_E &lt;-<span class="st"> </span>pracma<span class="op">::</span><span class="kw">cross</span>(n_EA_E, k_east_E)</code></pre></div>
<p><strong>Step 2</strong>: Find the initial direction vector <span class="math inline">\(d_E\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d_E &lt;-<span class="st"> </span>k_north_E <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(azimuth) <span class="op">+</span><span class="st"> </span>k_east_E <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(azimuth)</code></pre></div>
<p><strong>Step 3</strong>: Find <span class="math inline">\(\mathbf{n}_{EB}^E\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EB_E &lt;-<span class="st"> </span>n_EA_E <span class="op">*</span><span class="st"> </span><span class="kw">cos</span>(s_AB <span class="op">/</span><span class="st"> </span>r_Earth) <span class="op">+</span><span class="st"> </span>d_E <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(s_AB <span class="op">/</span><span class="st"> </span>r_Earth)</code></pre></div>
<p>Convert to longitude/latitude</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(l  &lt;-<span class="st"> </span><span class="kw">n_E2lat_lon</span>(n_EB_E) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">deg</span>())
<span class="co">#&gt; [1]  79.99155 -90.01770</span>
(latitude  &lt;-<span class="st"> </span>l[<span class="dv">1</span>])
<span class="co">#&gt; [1] 79.99155</span>
(longitude &lt;-<span class="st"> </span>l[<span class="dv">2</span>])
<span class="co">#&gt; [1] -90.0177</span></code></pre></div>
</div>
</div>
<div id="example-9-intersection-of-two-paths" class="section level2">
<h2>Example 9: Intersection of two paths</h2>
<p>Define a path from two given positions (at the surface of a spherical Earth), as the great circle that goes through the two points.</p>
<p>Path A is given by <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span>, while path B is given by <span class="math inline">\(B_1\)</span> and <span class="math inline">\(B_2\)</span>.</p>
<p>Find the position C where the two great circles intersect.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Intersection of two paths." width="220px" />
<p class="caption">
Intersection of two paths.
</p>
</div>
<div id="solution-8" class="section level3">
<h3>Solution</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EA1_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">50</span>), <span class="kw">rad</span>(<span class="dv">180</span>))
n_EA2_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">90</span>), <span class="kw">rad</span>(<span class="dv">180</span>))
n_EB1_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">60</span>), <span class="kw">rad</span>(<span class="dv">160</span>))
n_EB2_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">80</span>), <span class="kw">rad</span>(<span class="op">-</span><span class="dv">140</span>))

<span class="co"># These are from the python version (results are the same ;-)</span>
<span class="co"># n_EA1_E &lt;- lat_lon2n_E(rad(10), rad(20))</span>
<span class="co"># n_EA2_E &lt;- lat_lon2n_E(rad(30), rad(40))</span>
<span class="co"># n_EB1_E &lt;- lat_lon2n_E(rad(50), rad(60))</span>
<span class="co"># n_EB2_E &lt;- lat_lon2n_E(rad(70), rad(80))</span></code></pre></div>
<p>Find the intersection between the two paths, <span class="math inline">\(\mathbf{n}_{EC}^E\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EC_E_tmp &lt;-<span class="st"> </span><span class="kw">unit</span>(pracma<span class="op">::</span><span class="kw">cross</span>(
  pracma<span class="op">::</span><span class="kw">cross</span>(n_EA1_E, n_EA2_E),
  pracma<span class="op">::</span><span class="kw">cross</span>(n_EB1_E, n_EB2_E)))</code></pre></div>
<p><span class="math inline">\(\mathbf{n}_{{EC}_{tmp}}^E\)</span> is one of two solutions, the other is <span class="math inline">\(-\mathbf{n}_{{EC}_{tmp}}^E\)</span>. Select the one that is closest to <span class="math inline">\(\mathbf{n}_{EA_1}^E\)</span>, by selecting sign from the dot product between <span class="math inline">\(\mathbf{n}_{{EC}_{tmp}}^E\)</span> and <span class="math inline">\(\mathbf{n}_{EA_1}^E\)</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EC_E &lt;-<span class="st"> </span><span class="kw">sign</span>(pracma<span class="op">::</span><span class="kw">dot</span>(n_EC_E_tmp, n_EA1_E)) <span class="op">*</span><span class="st"> </span>n_EC_E_tmp</code></pre></div>
<p>Convert to longitude/latitude</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(l  &lt;-<span class="st"> </span><span class="kw">n_E2lat_lon</span>(n_EC_E) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">deg</span>())
<span class="co">#&gt; [1]  74.16345 180.00000</span>
(latitude  &lt;-<span class="st"> </span>l[<span class="dv">1</span>])
<span class="co">#&gt; [1] 74.16345</span>
(longitude &lt;-<span class="st"> </span>l[<span class="dv">2</span>])
<span class="co">#&gt; [1] 180</span></code></pre></div>
</div>
</div>
<div id="example-10-cross-track-distance-cross-track-error" class="section level2">
<h2>Example 10: Cross track distance (cross track error)</h2>
<p>Path A is given by the two positions <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span> (similar to the previous example).</p>
<p>Find the cross track distance <span class="math inline">\(s_{xt}\)</span> between the path A (i.e. the great circle through <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span>) and the position <span class="math inline">\(B\)</span> (i.e. the shortest distance at the surface, between the great circle and <span class="math inline">\(B\)</span>).</p>
<p>Also find the Euclidean distance <span class="math inline">\(d_{xt}\)</span> between <span class="math inline">\(B\)</span> and the plane defined by the great circle.</p>
<p>Use Earth radius <span class="math inline">\(6371~\mathrm{km}\)</span>.</p>
<p>Finally, find the intersection point on the great circle and determine if it is between position <span class="math inline">\(A_1\)</span> and <span class="math inline">\(A_2\)</span>.</p>
<div class="figure" style="text-align: center">
<img src="data:image/png;base64,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" alt="Cross track distance (cross track error)." width="220px" />
<p class="caption">
Cross track distance (cross track error).
</p>
</div>
<div id="solution-9" class="section level3">
<h3>Solution</h3>
<p>Given</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">n_EA1_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">0</span>), <span class="kw">rad</span>(<span class="dv">0</span>))
n_EA2_E &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">10</span>),<span class="kw">rad</span>(<span class="dv">0</span>))
n_EB_E  &lt;-<span class="st"> </span><span class="kw">lat_lon2n_E</span>(<span class="kw">rad</span>(<span class="dv">1</span>), <span class="kw">rad</span>(<span class="fl">0.1</span>))

r_Earth &lt;-<span class="st"> </span><span class="fl">6371e3</span>  <span class="co"># mean Earth radius (m)</span></code></pre></div>
<p>Find the unit normal to the great circle between n_EA1_E and n_EA2_E</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">c_E &lt;-<span class="st"> </span><span class="kw">unit</span>(pracma<span class="op">::</span><span class="kw">cross</span>(n_EA1_E, n_EA2_E))</code></pre></div>
<p>Find the great circle cross track distance</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(s_xt &lt;-<span class="st"> </span>(<span class="kw">acos</span>(pracma<span class="op">::</span><span class="kw">dot</span>(c_E, n_EB_E)) <span class="op">-</span><span class="st"> </span>pi <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>r_Earth)
<span class="co">#&gt; [1] 11117.8</span></code></pre></div>
<p>Find the Euclidean cross track distance</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(d_xt &lt;-<span class="st"> </span><span class="op">-</span>pracma<span class="op">::</span><span class="kw">dot</span>(c_E, n_EB_E) <span class="op">*</span><span class="st"> </span>r_Earth)
<span class="co">#&gt; [1] 11117.79</span></code></pre></div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-gade2010">
<p>Gade, Kenneth. 2010. “A Nonsingular Horizontal Position Representation.” <em>The Journal of Navigation</em> 63 (3): 395–417. <a href="www.navlab.net/Publications/A_Nonsingular_Horizontal_Position_Representation.pdf" class="uri">www.navlab.net/Publications/A_Nonsingular_Horizontal_Position_Representation.pdf</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
